<!-- ä¿å­˜ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒªã‚¢ -->
<section>
  <h2>ğŸ“š ä¿å­˜ã•ã‚ŒãŸéå»ã®å…¥åŠ›ä¸€è¦§</h2>
  <div id="saved-entries"></div>
</section>

<script>
  // ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  function getSavedData() {
    return JSON.parse(localStorage.getItem("homerareSteps")) || [];
  }

  // ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒãƒˆ
  function setSavedData(data) {
    localStorage.setItem("homerareSteps", JSON.stringify(data));
  }

  // å‰Šé™¤å‡¦ç†
  function deleteEntry(index) {
    const data = getSavedData();
    data.splice(index, 1);
    setSavedData(data);
    displaySavedEntries();
  }

  // å¾©å…ƒå‡¦ç†
  function restoreEntry(index) {
    const data = getSavedData();
    const steps = data[index].steps;
    steps.forEach((stepData, stepIndex) => {
      const inputs = document.querySelectorAll(`.step${stepIndex}`);
      stepData.forEach((val, i) => {
        if (inputs[i]) inputs[i].value = val;
      });
    });
    updateProgress();
    alert("ã“ã®è¨˜éŒ²ã‚’å¾©å…ƒã—ã¾ã—ãŸï¼");
  }

  // è¡¨ç¤ºå‡¦ç†
  function displaySavedEntries() {
    const savedData = getSavedData();
    const container = document.getElementById("saved-entries");
    container.innerHTML = "";

    if (savedData.length === 0) {
      container.innerHTML = "<p>ä¿å­˜ã•ã‚ŒãŸè¨˜éŒ²ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
      return;
    }

    savedData.forEach((entry, index) => {
      const entryDiv = document.createElement("div");
      entryDiv.classList.add("saved-entry");
      entryDiv.innerHTML = `
        <h3>è¨˜éŒ² ${index + 1}ï¼ˆ${entry.timestamp}ï¼‰</h3>
        <ul>
          ${entry.steps
            .map((step, i) => `<li><strong>STEP${i}:</strong> ${step.join(", ")}</li>`)
            .join("")}
        </ul>
        <button onclick="restoreEntry(${index})">ã“ã®è¨˜éŒ²ã‚’å¾©å…ƒ</button>
        <button onclick="deleteEntry(${index})">å‰Šé™¤</button>
        <hr />
      `;
      container.appendChild(entryDiv);
    });
  }

  // åˆæœŸè¡¨ç¤º
  window.addEventListener("DOMContentLoaded", () => {
    displaySavedEntries();
  });
</script>

<style>
  .saved-entry {
    background: #fff7ec;
    padding: 1em;
    border-radius: 8px;
    margin-bottom: 1em;
  }
  .saved-entry button {
    margin-right: 0.5em;
    background: #ffcc80;
    border: none;
    padding: 0.4em 0.8em;
    border-radius: 4px;
    cursor: pointer;
  }
  .saved-entry button:hover {
    background: #ffb74d;
  }
</style>
